var request = require('request');

function Bot(key, mode, url) {
  this.key = key || 'default';
  this.mode = mode || 'training';
  this.url = url || 'http://s.smtcs.rocks:9989';
  this.data = {};
  console.log(this);
}

Bot.prototype.start = function() {
  request.post({url: this.url + '/api' + this.mode, form: {key: this.key}}, function(err, res, body) {
    this.data = body;
    console.log(res.statusCode);
  });
  return this;
};

Bot.prototype.move = function(dir) {
  process.nextTick(function() {
    request.post({url: this.url + '/api/' + this.mode, form: {key: this.key, dir: dir}}, function(err, res, body) {
      this.data = body;
      console.log(body);
      console.log('Moved', dir);
      // console.log(res.statusCode);
    });
  });
};

Bot.prototype.mode = this.mode;

Bot.prototype.key = this.key;

Bot.prototype.data = this.data;

module.exports = Bot;
